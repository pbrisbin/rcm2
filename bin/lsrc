#!/bin/sh
: ${RCM_LIB:=$(dirname "$0")/../share/rcm}
. "$RCM_LIB"/rcm.sh

usage() {
  printf "Usage: lsrc [-FVqvh] [-I EXCL_PAT] [-x EXCL_PAT] [-t TAG] [-d DOT_DIR]\n"
  printf "see lsrc(1) and rcm(5) for more details\n"
}

process_dotfile() {
  local dotfile="$1" sigil

  if [ "$show_flags" -eq 1 ]; then
    if copy "$dotfile"; then
      sigil=":X"
    else
      sigil=":@"
    fi
  fi

  printf "%s:%s/%s%s\n" \
    "$(destination "$dotfile")" "$PWD" "$dotfile" "$sigil"
}

if parse_options "$@"; then
  hooks=0
  process_dotfiles
fi
